{% macro getFontStyles(fonts) -%}{%for key, value in fonts.items()%}{{key ~ ':ital,wght@'}}{%for index, size in enumerate(value.weight)%}{%if index > 0%};{%endif%}0,{{size}}{%endfor%}{%for index, size in enumerate(value.italic)%}{%if index > 0 or value.weight|length != 0 %};{%endif%}1,{{size}}{%endfor%}{% if not loop.last %}{{'&display=swap&family='}}{%endif%}{%endfor%}{%- endmacro %}

{% macro render_google_fonts(settings) %}
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    
    <!-- Load Thai-compatible fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Sarabun:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800&family=Noto+Sans+Thai:wght@100;200;300;400;500;600;700;800;900&display=swap"
        rel="stylesheet"
        id="thaiCompatibleFonts"
    />
    
    {% if settings.printHeaderFonts %}
        <link
            href="https://fonts.googleapis.com/css2?family={{getFontStyles(settings.printHeaderFonts)}}"
            rel="stylesheet"
            id="headerFontsLinkTag"
        />
    {%endif%}
    {% if settings.printBodyFonts %}
        <link
            href="https://fonts.googleapis.com/css2?family={{getFontStyles(settings.printBodyFonts)}}"
            rel="stylesheet"
            id="bodyFontsLinkTag"
        />
    {%endif%}
    {% if settings.printFooterFonts %}
        <link
            href="https://fonts.googleapis.com/css2?family={{getFontStyles(settings.printFooterFonts)}}"
            rel="stylesheet"
            id="footerFontsLinkTag"
        />
    {%endif%}
    
    <!-- CSS to add Thai font fallbacks to all font families -->
    <style>
        /* Override font-family declarations to include Thai fonts */
        * {
            font-family: inherit;
        }
        
        /* Add Thai fallbacks for common fonts */
        .print-format,
        .print-format * {
            font-family: inherit, 'Sarabun', 'Noto Sans Thai', sans-serif !important;
        }
        
        /* Specific font family overrides for Thai support */
        [style*="font-family: Inter"] {
            font-family: Inter, 'Sarabun', 'Noto Sans Thai', sans-serif !important;
        }
        
        [style*="font-family: Arial"] {
            font-family: Arial, 'Sarabun', 'Noto Sans Thai', sans-serif !important;
        }
        
        [style*="font-family: Helvetica"] {
            font-family: Helvetica, 'Sarabun', 'Noto Sans Thai', sans-serif !important;
        }
        
        /* CSS custom property fallback for dynamic font assignments */
        :root {
            --thai-font-fallback: 'Sarabun', 'Noto Sans Thai', sans-serif;
        }
    </style>
{% endmacro %}